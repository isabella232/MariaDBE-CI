{
  "builders": [
    {
      "type": "googlecompute",
      "project_id": "mariadb-enterprise-server",
      "source_image_project_id": "centos-cloud",
      "source_image": "centos-6-v20200309",
      "zone": "us-central1-a",
      "communicator": "ssh",
      "disk_size": "60",
      "image_name": "jw-centos-6-{{timestamp}}",
      "image_family": "jenkins-agent",
      "ssh_username": "centos"
    }
  ],
  "provisioners": [
    {
      "type": "shell",
      "inline": ["sudo yum -y install wget", "wget https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm",
          "sudo rpm -Uhv epel-release-latest-6.noarch.rpm && rm -frv epel-release-latest-6.noarch.rpm", "sudo yum -y upgrade",
          "sudo yum -y groupinstall 'Development Tools'", "sudo yum -y install git python-devel libffi-devel openssl-devel",
          "sudo yum -y install python-pip redhat-rpm-config curl bison libaio lsof perl-DBI boost-program-options ncurses-devel",
          "cd /etc/pki/rpm-gpg && sudo wget http://linuxsoft.cern.ch/cern/scl/RPM-GPG-KEY-cern",
          "cd /etc/yum.repos.d && sudo wget http://linuxsoft.cern.ch/cern/scl/slc6-scl.repo",
          "sudo yum -y install devtoolset-3-gcc-c++ devtoolset-3-valgrind-devel devtoolset-3-libasan-devel clang",
          "sudo yum install -y perl-Time-HiRes perl-Test-HTTP-Server-Simple", "sudo rm /etc/security/limits.d/90-nproc.conf",
          "sudo yum -y install curl-devel mhash-devel libxml2-devel curl-devel libaio-devel perl-XML-Simple scons boost-devel",
          "sudo yum -y install check-devel which Judy-devel cracklib-devel pam-devel rsync socat lsof valgrind-devel snappy-devel",
          "sudo yum -y install expect net-tools", "sudo yum -y erase cmake || true", 
          "wget https://cmake.org/files/v3.15/cmake-3.15.3-Linux-x86_64.sh -O /tmp/cmake-3.15.3-Linux-x86_64.sh",
          "sudo /bin/bash /tmp/cmake-3.15.3-Linux-x86_64.sh --prefix=/usr --exclude-subdir --skip-license",
          "rm -f /tmp/cmake-3.15.3-Linux-x86_64.sh", "sudo yum -y install java-1.8.0-openjdk-headless"]
    }
  ]
}
